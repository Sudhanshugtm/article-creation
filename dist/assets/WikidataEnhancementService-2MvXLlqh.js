var y=Object.defineProperty;var b=(l,a,i)=>a in l?y(l,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[a]=i;var m=(l,a,i)=>b(l,typeof a!="symbol"?a+"":a,i);class I{constructor(){m(this,"WIKIDATA_API","https://www.wikidata.org/w/api.php");m(this,"KATIE_BOUMAN_ID","Q63080922")}async getEnhancementSuggestions(a){try{const i=await this.fetchEntity(this.KATIE_BOUMAN_ID);if(!i)return[];const n=[],t=await this.generateFactSuggestions(i,a);n.push(...t);const e=await this.generateSectionSuggestions(i,a);return n.push(...e),n.sort((o,r)=>r.confidence-o.confidence)}catch(i){return console.error("Error fetching Wikidata suggestions:",i),this.getFallbackSuggestions()}}async fetchEntity(a){var e;const i=new URL(this.WIKIDATA_API);return i.searchParams.set("action","wbgetentities"),i.searchParams.set("ids",a),i.searchParams.set("format","json"),i.searchParams.set("origin","*"),((e=(await(await fetch(i.toString())).json()).entities)==null?void 0:e[a])||null}async generateFactSuggestions(a,i){const n=[],t=i.toLowerCase();if(a.claims.P569&&!t.includes("born")&&!t.includes("birth")){const e=a.claims.P569[0];if(e.mainsnak.datavalue){const o=new Date(e.mainsnak.datavalue.value.time.substring(1,11));n.push({id:"birth-date",type:"fact",title:"Add birth date",content:`Katie Bouman was born on ${o.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}.`,source:"wikidata",property:"P569",confidence:.9,hint:"Basic biographical information"})}}if(a.claims.P69&&!t.includes("university of michigan")){const e=a.claims.P69;for(const o of e)if(o.mainsnak.datavalue){const r=o.mainsnak.datavalue.value.id,s=await this.getItemLabel(r);s&&!t.includes(s.toLowerCase())&&n.push({id:`alma-mater-${r}`,type:"fact",title:`Add education at ${s}`,content:`She studied at ${s}.`,source:"wikidata",property:"P69",confidence:.8,hint:"Educational background"})}}if(a.claims.P108&&!t.includes("california institute of technology")){const e=a.claims.P108;for(const o of e)if(o.mainsnak.datavalue){const r=o.mainsnak.datavalue.value.id,s=await this.getItemLabel(r);s&&!t.includes(s.toLowerCase())&&n.push({id:`employer-${r}`,type:"fact",title:`Add current position at ${s}`,content:`She is currently affiliated with ${s}.`,source:"wikidata",property:"P108",confidence:.85,hint:"Current professional affiliation"})}}return n}async generateSectionSuggestions(a,i){const n=[],t=i.toLowerCase();if(a.claims.P166&&!t.includes("awards")){const e=await this.extractAwards(a.claims.P166);e.length>0&&n.push({id:"awards-section",type:"section",title:"Awards",content:this.generateAwardsSection(e),source:"wikidata",property:"P166",confidence:.9,hint:`Found ${e.length} award${e.length>1?"s":""} in Wikidata`})}if(a.claims.P69&&!t.includes("education")){const e=await this.extractEducation(a.claims.P69);e.length>0&&n.push({id:"education-section",type:"section",title:"Education",content:this.generateEducationSection(e),source:"wikidata",property:"P69",confidence:.85,hint:"Academic background and degrees"})}if(a.claims.P800&&!t.includes("notable works")){const e=await this.extractNotableWorks(a.claims.P800);e.length>0&&n.push({id:"works-section",type:"section",title:"Notable Works",content:this.generateWorksSection(e),source:"wikidata",property:"P800",confidence:.8,hint:`Found ${e.length} notable work${e.length>1?"s":""}`})}return n}async getItemLabel(a){var i,n;try{const t=await this.fetchEntity(a);return((n=(i=t==null?void 0:t.labels)==null?void 0:i.en)==null?void 0:n.value)||null}catch{return null}}async extractAwards(a){var n,t,e,o,r;const i=[];for(const s of a.slice(0,10))if(s.mainsnak.datavalue){const u=s.mainsnak.datavalue.value.id,c=await this.getItemLabel(u);if(c){const d=(r=(o=(e=(t=(n=s.qualifiers)==null?void 0:n.P585)==null?void 0:t[0])==null?void 0:e.datavalue)==null?void 0:o.value)!=null&&r.time?new Date(s.qualifiers.P585[0].datavalue.value.time.substring(1,5)).getFullYear():void 0;i.push({name:c,year:d})}}return i}async extractEducation(a){var n,t,e,o,r,s,u,c,d,g;const i=[];for(const h of a)if(h.mainsnak.datavalue){const w=h.mainsnak.datavalue.value.id,f=await this.getItemLabel(w);if(f){const p=(r=(o=(e=(t=(n=h.qualifiers)==null?void 0:n.P512)==null?void 0:t[0])==null?void 0:e.datavalue)==null?void 0:o.value)==null?void 0:r.id,v=p&&await this.getItemLabel(p)||void 0,k=(g=(d=(c=(u=(s=h.qualifiers)==null?void 0:s.P582)==null?void 0:u[0])==null?void 0:c.datavalue)==null?void 0:d.value)!=null&&g.time?new Date(h.qualifiers.P582[0].datavalue.value.time.substring(1,5)).getFullYear():void 0;i.push({institution:f,degree:v,year:k})}}return i}async extractNotableWorks(a){var n,t,e,o,r;const i=[];for(const s of a.slice(0,8))if(s.mainsnak.datavalue){const u=s.mainsnak.datavalue.value.id,c=await this.getItemLabel(u);if(c){const d=(r=(o=(e=(t=(n=s.qualifiers)==null?void 0:n.P577)==null?void 0:t[0])==null?void 0:e.datavalue)==null?void 0:o.value)!=null&&r.time?new Date(s.qualifiers.P577[0].datavalue.value.time.substring(1,5)).getFullYear():void 0;i.push({title:c,year:d})}}return i}generateAwardsSection(a){return`<p>Bouman has received recognition for her contributions to computational imaging and the Event Horizon Telescope project:</p>
                <ul>
                    ${a.sort((t,e)=>(e.year||0)-(t.year||0)).map(t=>`<li>${t.year?t.year+" - ":""}${t.name}</li>`).join(`
                    `)}
                </ul>`}generateEducationSection(a){return`<p>Bouman completed her education at the following institutions:</p>
                <ul>
                    ${a.sort((t,e)=>(t.year||0)-(e.year||0)).map(t=>{let e=t.degree?`${t.degree} - ${t.institution}`:t.institution;return t.year&&(e+=` (${t.year})`),`<li>${e}</li>`}).join(`
                    `)}
                </ul>`}generateWorksSection(a){return`<p>Bouman has contributed to several significant works in computational imaging:</p>
                <ul>
                    ${a.sort((t,e)=>(e.year||0)-(t.year||0)).map(t=>`<li>${t.year?t.year+" - ":""}"${t.title}"</li>`).join(`
                    `)}
                </ul>`}getFallbackSuggestions(){return[{id:"harvard-fallback",type:"fact",title:"Harvard postdoctoral fellowship",content:"Bouman joined Harvard University as a postdoctoral fellow on the Event Horizon Telescope Imaging team (2018)",source:"wikidata",confidence:.8,hint:"Career milestone"},{id:"caltech-fallback",type:"fact",title:"Caltech professorship",content:"She then joined the California Institute of Technology (Caltech) as an assistant professor in June 2019, later promoted to associate professor",source:"wikidata",confidence:.8,hint:"Current position"}]}}export{I as W};
