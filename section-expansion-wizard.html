<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Katie Bouman - Wikipedia</title>
  <!-- Dev-friendly: load source TS and CSS; Vite bundles for prod -->
  <script type="module" src="./src/wizard-script.js"></script>
  <link rel="stylesheet" href="./src/styles/codex.css">
  <link rel="stylesheet" href="./src/styles/section-expansion.css">
  <link rel="stylesheet" href="./src/styles/wizard-overlay.css">
</head>
<body>
    <div class="article-expansion">
        <!-- Wikipedia-style header -->
        <header class="article-header">
            <div class="article-header__nav">
                <button class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled" onclick="window.location.href='./section-creation.html'">
                    <span class="cdx-icon cdx-icon--medium">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
                            <path d="M4 10l5-5v3h7v4h-7v3z"/>
                        </svg>
                    </span>
                </button>
            </div>
            <div class="article-header__title-wrapper">
                <h1 class="article-header__title" id="articleTitle">Katie Bouman</h1>
                <div class="article-header__subtitle" id="articleSubtitle">American computer scientist and engineer</div>
            </div>
        </header>

        <!-- Article content -->
        <main class="article-content">
            <article class="article-body" id="articleBody">
                <!-- Dynamic content will be loaded here -->
            </article>
        </main>

        <!-- Smart Widget -->
        <div class="smart-widget" id="smartWidget">
            <button class="smart-widget__trigger" id="smartWidgetTrigger" onclick="openSectionWizard()">
                <span class="smart-widget__icon">üßô‚Äç‚ôÇÔ∏è</span>
                <span class="smart-widget__text">Add a section</span>
            </button>
        </div>

        <!-- Section Wizard Overlay -->
        <div class="wizard-overlay" id="sectionWizard" style="display: none;">
            <div class="wizard-backdrop"></div>
            <div class="wizard-container">
                <!-- Header with stepper -->
                <div class="wizard-header">
                    <div class="wizard-header-left">
                        <h2 class="wizard-title">Add a section</h2>
                        <div class="wizard-stepper">
                            <div class="stepper-item active">
                                <span class="stepper-number">1</span>
                                <span class="stepper-label">Pick</span>
                            </div>
                            <div class="stepper-arrow">‚Üí</div>
                            <div class="stepper-item">
                                <span class="stepper-number">2</span>
                                <span class="stepper-label">Sources</span>
                            </div>
                            <div class="stepper-arrow">‚Üí</div>
                            <div class="stepper-item">
                                <span class="stepper-number">3</span>
                                <span class="stepper-label">Review</span>
                            </div>
                        </div>
                    </div>
                    <button class="wizard-close" id="wizardClose" title="Close wizard">√ó</button>
                </div>

                <!-- Context row -->
                <div class="wizard-context">
                    <span class="context-page-title" id="contextPageTitle">Article</span>
                    <span class="context-article-type">Biography</span>
                    <span class="context-blp-badge">BLP</span>
                </div>

                <!-- Main content area -->
                <div class="wizard-content">
                    <!-- Step 1: Pick a section -->
                    <div class="wizard-step" id="step1">
                        <h3 class="step-title">Step 1 ¬∑ Pick a section</h3>
                        
                        <div class="section-suggestions">
                            <div class="section-card" data-section="personal-life">
                                <h4 class="section-card-title">Personal life</h4>
                                <p class="section-card-why">Readers want to know about background and inspirations</p>
                            </div>

                            <div class="section-card" data-section="awards-honors">
                                <h4 class="section-card-title">Awards and honors</h4>
                                <p class="section-card-why">Recognition for groundbreaking contributions</p>
                            </div>

                            <div class="section-card" data-section="technical-innovations">
                                <h4 class="section-card-title">Technical innovations</h4>
                                <p class="section-card-why">Specific algorithmic contributions deserve explanation</p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Sources -->
                    <div class="wizard-step" id="step2" style="display: none;">
                        <h3 class="step-title">Step 2 ¬∑ Sources</h3>
                        
                        <div class="chosen-section">
                            <span class="chosen-section-label">Section: </span>
                            <span class="chosen-section-name" id="chosenSectionName"></span>
                        </div>

                        <div class="source-input-area">
                            <div class="source-input-group">
                                <input type="url" placeholder="Paste a source URL..." class="source-url-input" id="sourceUrlInput">
                                <button class="add-source-btn" id="addSourceBtn">Add</button>
                            </div>
                        </div>

                        <div class="sources-list" id="sourcesList">
                            <!-- Added sources will appear here -->
                        </div>

                        <div class="sources-nudge" id="sourcesNudge" style="display: none;">
                            <p>üí° Consider adding at least one reliable source to support your content.</p>
                        </div>
                    </div>

                    <!-- Step 3: Review -->
                    <div class="wizard-step" id="step3" style="display: none;">
                        <h3 class="step-title">Step 3 ¬∑ Review</h3>
                        
                        <div class="chosen-section">
                            <span class="chosen-section-label">Section: </span>
                            <span class="chosen-section-name" id="chosenSectionName3"></span>
                        </div>

                        <div class="review-checks" id="reviewChecks">
                            <!-- Review issues will appear here -->
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="wizard-footer">
                    <div class="wizard-footer-left">
                        <a href="#" class="help-link">Help / policies</a>
                    </div>
                    <div class="wizard-footer-right">
                        <button class="wizard-btn-back" id="wizardBack" style="display: none;">Back</button>
                        <button class="wizard-btn-skip" id="wizardSkip" style="display: none;">Skip for now</button>
                        <button class="wizard-btn-cancel" id="wizardCancel">Cancel</button>
                        <button class="wizard-btn-continue" id="wizardContinue" disabled>Continue</button>
                        <button class="wizard-btn-insert" id="wizardInsert" style="display: none;" disabled>Finish</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Source Palette -->
        <div class="source-palette" id="sourcePalette" style="display: none;">
            <div class="source-palette-header">
                <span class="source-palette-title">Sources</span>
                <button class="source-palette-close" id="sourcePaletteClose" title="Close">√ó</button>
            </div>
            <div class="source-palette-content" id="sourcePaletteContent">
                <!-- Source statements will appear here -->
            </div>
        </div>
    </div>

    <script>
        // Load selected article content from sessionStorage
        document.addEventListener('DOMContentLoaded', function() {
            const selectedArticleData = sessionStorage.getItem('selectedArticle');
            
            if (selectedArticleData) {
                const article = JSON.parse(selectedArticleData);
                loadArticleContent(article);
            } else {
                // Fallback to Katie Bouman if no selection found
                loadDefaultContent();
            }
        });

        function loadArticleContent(article) {
            // Update page title and header
            document.getElementById('pageTitle').textContent = article.title + ' - Wikipedia';
            document.getElementById('articleTitle').textContent = article.title;
            document.getElementById('articleSubtitle').textContent = article.description;
            
            // Convert MediaWiki markup to HTML
            const htmlContent = convertMediaWikiToHTML(article.content);
            document.getElementById('articleBody').innerHTML = htmlContent;
            
            // Update suggestion count in the smart widget
            updateSuggestionCount(article.id || 'katie-bouman');
        }

        function convertMediaWikiToHTML(mediaWikiText) {
            let html = mediaWikiText;
            
            // Convert section headers
            html = html.replace(/^== (.+?) ==$/gm, '<section class="article-section"><h2 class="article-section__title">$1</h2><div class="article-section__content">');
            html = html.replace(/^=== (.+?) ===$/gm, '<h3 class="article-subsection__title">$1</h3>');
            
            // Convert paragraphs - split by double newlines and wrap non-markup text in <p> tags
            html = html.split('\n\n').map(paragraph => {
                paragraph = paragraph.trim();
                if (paragraph === '') return '';
                if (paragraph.startsWith('<section') || paragraph.startsWith('<h3') || paragraph.startsWith('*') || paragraph.startsWith('{{')) {
                    return paragraph;
                }
                return '<p>' + paragraph + '</p>';
            }).join('\n');
            
            // Close section divs before new sections
            html = html.replace(/<section class="article-section">/g, '</div></section><section class="article-section">');
            html = html.replace(/^<\/div><\/section>/, ''); // Remove first closing tags
            
            // Convert lists
            html = html.replace(/^\* (.+)$/gm, '<li>$1</li>');
            html = html.replace(/(<li>.*<\/li>)/s, '<ul>$1</ul>');
            
            // Convert wiki links to regular links (simplified)
            html = html.replace(/\[\[([^\]|]+)(\|[^\]]+)?\]\]/g, '<a href="#" class="wiki-link">$1</a>');
            
            // Convert external links (simplified)
            html = html.replace(/\[([^\s]+) ([^\]]+)\]/g, '<a href="$1" class="external-link">$2</a>');
            
            // Convert bold text
            html = html.replace(/'''(.+?)'''/g, '<strong>$1</strong>');
            
            // Convert italic text
            html = html.replace(/''(.+?)''/g, '<em>$1</em>');
            
            // Add closing div for last section
            html += '</div></section>';
            
            // Add placeholder for new sections
            html += '<div id="newSectionsContainer"></div>';
            
            return html;
        }

        function loadDefaultContent() {
            const defaultArticle = {
                id: 'katie-bouman',
                title: 'Katie Bouman',
                description: 'American computer scientist and engineer',
                content: `'''Katherine Louise Bouman''' (born 1989) is an American [[engineer]] and [[computer scientist]] working in the field of [[computational imaging]]. She led the development of an [[algorithm]] for imaging [[black hole]]s, known as [[CHIRP (algorithm)|Continuous High-resolution Image Reconstruction using Patch priors]] (CHIRP), and was a member of the [[Event Horizon Telescope]] team that captured the first image of a black hole.

== Early life and education ==
Bouman grew up in [[West Lafayette, Indiana]]. Her father, [[Charles Bouman]], is a professor of [[electrical and computer engineering]] and [[biomedical engineering]] at [[Purdue University]].

== Research and career ==
After earning her doctorate, Bouman joined [[Harvard University]] as a [[postdoctoral fellow]] on the Event Horizon Telescope Imaging team. She led the development of an algorithm for imaging black holes, known as [[CHIRP (algorithm)|Continuous High-resolution Image Reconstruction using Patch priors]] (CHIRP).

== Recognition ==
She was recognized as one of the [[BBC]]'s [[100 Women (BBC)#2019|100 women of 2019]]. In 2024, Bouman was awarded a [[Sloan Research Fellowship]].`
            };
            loadArticleContent(defaultArticle);
        }

        function updateSuggestionCount(articleId) {
            // Same suggestion sets as in section-suggestions.html
            const suggestionSets = {
                'katie-bouman': {
                    facts: 2, // Harvard, Caltech
                    sections: 2 // Awards, Notable Works
                },
                'john-langford': {
                    facts: 3, // Education, PhD, Microsoft
                    sections: 3 // Education, Career, Research
                },
                'henri-gouraud': {
                    facts: 3, // Birth, nephew, face-capture
                    sections: 2 // Early life, Legacy
                },
                'eduardo-caianiello': {
                    facts: 3, // Institutes, cybernetics, hafnian
                    sections: 3 // Career, Research, Legacy
                },
                'patrick-mchale': {
                    facts: 3, // Birth, CalArts, awards
                    sections: 1 // Awards and recognition
                }
            };

            const suggestions = suggestionSets[articleId] || suggestionSets['katie-bouman'];
            const totalCount = suggestions.facts + suggestions.sections;
            
            const suggestionCountElement = document.getElementById('suggestionCount');
            if (suggestionCountElement) {
                suggestionCountElement.textContent = `${totalCount} ideas`;
            }
        }
    </script>
    
    <style>
        .loading-content {
            text-align: center;
            padding: 40px 20px;
            color: #72777d;
            font-style: italic;
        }
    </style>

</body>
</html>
